<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Smart Biopsy Needle: Battery Macros</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Smart Biopsy Needle<span id="projectnumber">&#160;v1.0.0</span>
   </div>
   <div id="projectbrief">This project focuses on the electronics implementation for the University of Florida Nontraditional Manufacturing Lab&#39;s aspiration-assisted biopsy needle.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle"><div class="title">Battery Macros</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga24c290b5fa8c0bb248fc15b5bcf873d7" id="r_ga24c290b5fa8c0bb248fc15b5bcf873d7"><td class="memItemLeft" align="right" valign="top"><a id="ga24c290b5fa8c0bb248fc15b5bcf873d7" name="ga24c290b5fa8c0bb248fc15b5bcf873d7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NTM_MAX</b>(A,  B)&#160;&#160;&#160;((A) &gt;= (B) ? (A) : (B))</td></tr>
<tr class="memdesc:ga24c290b5fa8c0bb248fc15b5bcf873d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the bigger value between A and B using operator. Essentially: if (A) &gt;= (B) return A. Else return B. <br /></td></tr>
<tr class="separator:ga24c290b5fa8c0bb248fc15b5bcf873d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a187ecf82734a12819e1283bcb69bab" id="r_ga9a187ecf82734a12819e1283bcb69bab"><td class="memItemLeft" align="right" valign="top"><a id="ga9a187ecf82734a12819e1283bcb69bab" name="ga9a187ecf82734a12819e1283bcb69bab"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NTM_MIN</b>(A,  B)&#160;&#160;&#160;((A) &lt;= (B) ? (A) : (B))</td></tr>
<tr class="memdesc:ga9a187ecf82734a12819e1283bcb69bab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the smaller value between A and B using operator. Essentially: if (A) &lt;= (B) return A. Else return B. <br /></td></tr>
<tr class="separator:ga9a187ecf82734a12819e1283bcb69bab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7703a5d829fb6d1223ad111a9474fa9b" id="r_ga7703a5d829fb6d1223ad111a9474fa9b"><td class="memItemLeft" align="right" valign="top"><a id="ga7703a5d829fb6d1223ad111a9474fa9b" name="ga7703a5d829fb6d1223ad111a9474fa9b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BAT_MAX_ADC</b>&#160;&#160;&#160;((int)(0.5 + (4095/3.3) * (4.2/2)))</td></tr>
<tr class="memdesc:ga7703a5d829fb6d1223ad111a9474fa9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents the battery's max capacity from the perspective of the microcontroller. This code maps the battery's voltage to the ADC module value. The battery's "maximum charge" is 4.2 V which is too much for the pins to handle so we halve it using a voltage divider. Therefore, when the battery is at maximum the microcontroller pin recieves 2.1 V. We then map this to the 12 bit ADC value. There are 12 bits to represent the voltage so 4096 corresponding values (inclusive of 0) with a maximum of 3.3 V recievable by the pin. When we multiply these to values together we are figuring out what the ADC value of the battery is at maximum charge (4.2 V / 2) 0.5 is just a value to round this result to the nearest whole integer. <br /></td></tr>
<tr class="separator:ga7703a5d829fb6d1223ad111a9474fa9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad380f4a571d5444566336f067dfb7b01" id="r_gad380f4a571d5444566336f067dfb7b01"><td class="memItemLeft" align="right" valign="top"><a id="gad380f4a571d5444566336f067dfb7b01" name="gad380f4a571d5444566336f067dfb7b01"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BAT_MIN_ADC</b>&#160;&#160;&#160;((int)(0.5 + (4095/3.3) * (3.2/2)))</td></tr>
<tr class="memdesc:gad380f4a571d5444566336f067dfb7b01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents the battery's min capacity from the perspective of the microcontroller. This code maps the battery's voltage to the ADC module value. The battery's "minimum charge" is 3.2 V. To be consistent with what we did for the maximum voltage we halve it using a voltage divider. Therefore, when the battery is at maximum the microcontroller pin recieves 1.6 V. We then map this to the 12 bit ADC value. There are 12 bits to represent the voltage so 4096 corresponding values (inclusive of 0) with a maximum of 3.3 V recievable by the pin. When we multiply these to values together we are figuring out what the ADC value of the battery is at maximum charge (3.2 V / 2) 0.5 is just a value to round this result to the nearest whole integer. <br /></td></tr>
<tr class="separator:gad380f4a571d5444566336f067dfb7b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4ea44361cc7ac80f146feb2806720fda" id="r_ga4ea44361cc7ac80f146feb2806720fda"><td class="memItemLeft" align="right" valign="top"><a id="ga4ea44361cc7ac80f146feb2806720fda" name="ga4ea44361cc7ac80f146feb2806720fda"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BAT_ADC_PER</b>&#160;&#160;&#160;(100.0 / (<a class="el" href="group__BatteryMacros.html#ga7703a5d829fb6d1223ad111a9474fa9b">BAT_MAX_ADC</a> - <a class="el" href="group__BatteryMacros.html#gad380f4a571d5444566336f067dfb7b01">BAT_MIN_ADC</a>))</td></tr>
<tr class="memdesc:ga4ea44361cc7ac80f146feb2806720fda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Looks strange out of context. Used to calculate the batter capacity i.e. (Current Battery Value - BAT_MIN_ADC) * BAT_ADC_PER = % Capacity. <br /></td></tr>
<tr class="separator:ga4ea44361cc7ac80f146feb2806720fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81b58a672e9a97383f06a46f89660b1d" id="r_ga81b58a672e9a97383f06a46f89660b1d"><td class="memItemLeft" align="right" valign="top"><a id="ga81b58a672e9a97383f06a46f89660b1d" name="ga81b58a672e9a97383f06a46f89660b1d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SEC_US</b>&#160;&#160;&#160;1000000</td></tr>
<tr class="memdesc:ga81b58a672e9a97383f06a46f89660b1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">1 Second in microseconds. <br /></td></tr>
<tr class="separator:ga81b58a672e9a97383f06a46f89660b1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Macros used for calculating the battery capacity. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
