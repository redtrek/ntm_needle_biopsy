This is legacy code. Its been reorganized by me so its readable but a lot of components don't make any sense anymore.